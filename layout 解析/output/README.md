# Layout 解析输出说明

本目录包含从三个 JSON 文件分别解析生成的结构化表格数据。

## 📂 目录结构

```
output/
├── original/                              # 原始屋顶数据解析结果 (sample)
├── final/                                 # 最终方案数据解析结果 (sample)
├── create/                                # 项目创建数据解析结果 (sample，包含3个设计方案)
├── data_577_19_Barrob_St_Old_Beach_TAS_7017/  # 实际项目数据 (19 Barrob St)
└── README.md                              # 本说明文档
```

---

## 📁 Part 1: Original (原始屋顶数据)

**数据源**: `sample/sample-original.json`  
**输出目录**: `output/original/`

### 文件列表

#### 1. 完整屋顶数据
- **文件**: `01_完整屋顶数据.csv` / `01_完整屋顶数据.md`
- **说明**: 包含所有6个屋顶的完整详细信息
- **字段**: 屋顶编号、光伏面板数量、是否安装面板、朝向角度和描述、坡度、起点/终点/中心坐标、屋顶长度

#### 2. 汇总统计
- **文件**: `02_汇总统计.csv` / `02_汇总统计.md`
- **内容**: 总屋顶数量、已安装/未安装面板的屋顶数量、光伏面板总数、平均/最大/最小坡度

#### 3. 按朝向分类统计
- **文件**: `03_按朝向分类统计.csv` / `03_按朝向分类统计.md`
- **说明**: 按屋顶朝向（东/西/南/北）分组统计

#### 4. 已安装面板屋顶
- **文件**: `04_已安装面板屋顶.csv` / `04_已安装面板屋顶.md`
- **说明**: 仅包含已安装光伏面板的屋顶（2个）

#### 5. 未安装面板屋顶
- **文件**: `05_未安装面板屋顶.csv` / `05_未安装面板屋顶.md`
- **说明**: 仅包含未安装光伏面板的屋顶（4个）

### 数据摘要

| 指标 | 数值 |
|------|------|
| 总屋顶数量 | 6 |
| 已安装面板屋顶 | 2 |
| 未安装面板屋顶 | 4 |
| 光伏面板总数 | 2 |
| 平均坡度 | 23° |

---

## 📁 Part 2: Final (最终方案数据)

**数据源**: `sample/sample-final.json`  
**输出目录**: `output/final/`

### 文件列表

#### 1. 项目基本信息
- **文件**: `01_项目基本信息.csv` / `01_项目基本信息.md`
- **内容**: 项目ID (576)、GIS时间ID、GIS日期、安装面板总数 (3)

#### 2. 面板详细信息
- **文件**: `02_面板详细信息.csv` / `02_面板详细信息.md`
- **说明**: 包含每块面板的位置、朝向、坡度、年度发电量和12个月的月度发电量
- **字段**: 面板编号、位置坐标、朝向、坡度、计算状态、年度总发电量、1-12月发电量

#### 3. 发电量汇总统计
- **文件**: `03_发电量汇总统计.csv` / `03_发电量汇总统计.md`
- **内容**: 面板总数、年度总发电量、平均/最大/最小单板年发电量

#### 4. 按朝向分类统计
- **文件**: `04_按朝向分类统计.csv` / `04_按朝向分类统计.md`
- **说明**: 按面板朝向分组统计发电量

#### 5. 月度发电量汇总
- **文件**: `05_月度发电量汇总.csv` / `05_月度发电量汇总.md`
- **说明**: 12个月的总发电量和平均单板发电量

### 数据摘要

| 指标 | 数值 |
|------|------|
| 项目ID | 576 |
| 面板总数 | 2 |
| 年度总发电量 | 32.3 kWh |
| 平均单板年发电量 | 16.15 kWh |
| 最高月发电量 | 12月 (4.46 kWh) |
| 最低月发电量 | 6月 (1.0 kWh) |

---

## 🧮 计算说明

### Original 数据
1. **光伏面板数量**: 从 `positions` 数组计算，每6个元素代表一个面板
2. **朝向描述**: 将 `aspect` 角度转换为8个方向
3. **坡度**: 同时提供弧度和角度两种单位
4. **屋顶长度**: 计算起点和终点之间的欧几里得距离

### Final 数据
1. **面板位置**: 从 `positions` 数组提取，每3个元素代表一个坐标点 (x, y, z)
2. **发电量**: 从 `monthlyHourlyPowerList` 计算，包含12个月×24小时的发电数据
3. **年度总发电量**: 所有月份所有小时发电量的总和
4. **月度发电量**: 每月24小时发电量的总和

---

## 🔄 更新数据

如需重新生成表格，运行：

```bash
python3 ../parse_layout_v2.py
```

---

## 📝 数据格式

- **CSV**: 适合 Excel 打开和数据分析
- **Markdown**: 适合文档查看和版本控制

---

---

## 📁 Part 3: Create (项目创建数据)

**数据源**: `sample/sample-create.json`  
**输出目录**: `output/create/`

### 文件列表

#### 1. 项目基本信息
- **文件**: `01_项目基本信息.csv` / `01_项目基本信息.md`
- **内容**: 项目ID (577)、地址、经纬度、安装商代码、地图链接、设计方案数量 (3)

#### 2. 设计方案汇总
- **文件**: `02_设计方案汇总.csv` / `02_设计方案汇总.md`
- **说明**: 所有设计方案的完整参数（投资、补贴、回本期、电池容量等）

#### 3. 设计方案对比
- **文件**: `03_设计方案对比.csv` / `03_设计方案对比.md`
- **说明**: 三个方案（maxValue、customFit、mostPopular）的关键指标对比

#### 4. 各方案面板详情
- **文件**: `04_[方案名称]_面板详情.csv` / `.md` (3个文件)
- **说明**: 每个方案的屋顶布局和月度发电量详情

### 数据摘要

| 指标 | 数值 |
|------|------|
| 项目ID | 577 |
| 地址 | 19 Barrob St, Old Beach TAS 7017, Australia |
| 设计方案数 | 3 (maxValue, customFit, mostPopular) |
| 系统大小 | 7.04 kW (所有方案) |
| 面板总数 | 16 块 (所有方案) |
| 年度发电量 | 980.6 kWh (所有方案) |
| 电池容量 | 5.03 - 22.22 kWh (不同方案) |
| 前期投资 | $7,584 - $14,920 (不同方案) |

---

## 📊 三数据源对比分析

| 项目 | Original | Final | Create |
|------|----------|-------|--------|
| **数据类型** | 原始屋顶布局 | 最终安装方案 | 项目创建（多方案） |
| **屋顶/面板数** | 6个屋顶 | 2块面板 | 16块面板 (2个屋顶) |
| **包含发电量** | ❌ | ✅ | ✅ |
| **包含坐标范围** | ✅ (起点/终点) | ❌ | ❌ |
| **月度数据** | ❌ | ✅ (12个月) | ✅ (12个月) |
| **设计方案** | ❌ | 单一方案 | 3个方案对比 |
| **财务信息** | ❌ | ❌ | ✅ (投资/补贴/IRR) |
| **电池配置** | ❌ | ❌ | ✅ (3种配置) |

---

## 📁 Part 4: Data Projects (实际项目数据)

**数据源**: `data/[项目地址]/final.json`  
**输出目录**: `output/data_[项目ID]_[地址简称]/`

### 当前已解析项目

#### 1. 19 Barrob St, Old Beach TAS 7017
- **输出目录**: `data_577_19_Barrob_St_Old_Beach_TAS_7017/`
- **项目ID**: 577
- **地址**: 19 Barrob St, Old Beach TAS 7017, Australia
- **坐标**: 147.2752573, -42.7520648
- **设计方案数**: 3 (maxValue, customFit, mostPopular)
- **系统大小**: 7.04 kW
- **面板总数**: 16 块 (2个屋顶)
- **年度发电量**: 980.6 kWh
- **电池容量范围**: 5.03 - 22.22 kWh
- **前期投资范围**: $7,584 - $14,920

---

---

## 📁 Part 5: Layout Detail (布局详细数据)

**数据源**: `data/[项目地址]/layout.json`  
**输出目录**: `output/data_[项目ID]_[地址简称]/layout_detail/`

### 数据特点

`layout.json` 是纯粹的布局和发电量数据，包含：
- 面板位置坐标
- 屋顶朝向和坡度
- 月度发电量（12个月）
- **小时发电量**（12月 × 24小时 = 288个数据点）

### 当前已解析项目

#### 1. 19 Barrob St, Old Beach TAS 7017
- **输出目录**: `data_577_19_Barrob_St_Old_Beach_TAS_7017/layout_detail/`
- **项目ID**: 577
- **GIS日期**: 20250119
- **面板总数**: 16 块
- **屋顶数量**: 2 个
- **年度发电量**: 980.6 kWh

**生成文件**:
- `01_Layout基本信息` - 项目ID、GIS信息、面板总数
- `02_面板详细信息` - 每个屋顶的配置和月度发电量
- `03_月度发电量汇总` - 所有屋顶的月度汇总（含总计）
- `04_屋顶[N]_小时发电量` - 每个屋顶的小时级数据（12月×24小时）

---

## 🔄 更新数据

重新生成所有表格：

```bash
# Sample 数据 - Original & Final
python3 ../parse_layout_v2.py

# Sample 数据 - Create
python3 ../parse_create.py

# 实际项目数据 - Final (设计方案)
python3 ../parse_data_final.py

# 实际项目数据 - Layout (布局详情)
python3 ../parse_data_layout.py
```

**注意**: 
- `parse_data_final.py` 会自动扫描 `data/` 目录下所有的 `final.json` 文件
- `parse_data_layout.py` 会自动扫描 `data/` 目录下所有的 `layout.json` 文件

---

*生成时间: 2025-10-26*  
*数据源: sample/sample-original.json, sample/sample-final.json, sample/sample-create.json, data/[项目地址]/final.json, data/[项目地址]/layout.json*
