# 20年240个月太阳能财务计算模拟数据

## ✅ 任务完成总结

基于 `20.md` 中的Java代码逻辑和 `moni.md` 中的分析文档，已成功生成完整的20年240个月太阳能系统财务模拟数据。

---

## 📦 生成的文件（共8个）

### 核心数据文件

1. **`financial_simulation_240months.json`** (139 KB)
   - 完整的240个月JSON格式数据
   - 包含元数据、总结和逐月详细数据
   - 适合程序化分析和API调用

2. **`财务数据_240个月.csv`** (22 KB)
   - Excel可读的表格数据
   - 16列 × 240行
   - 适合Excel数据透视表和图表分析

### 分析报告

3. **`数据分析报告.md`** (6 KB)
   - 详细的数据分析和洞察
   - 包含年度趋势、月度示例、关键发现
   - 投资价值评估和优化建议

4. **`使用指南.md`** (6.5 KB)
   - 完整的使用说明
   - 快速开始指南
   - 自定义模拟教程

### 工具脚本

5. **`financial_simulator.py`** (12 KB)
   - Python财务模拟器源代码
   - 可自定义参数重新模拟
   - 包含完整的计算逻辑

6. **`export_csv.py`** (2 KB)
   - JSON转CSV工具
   - 自动格式化中文列名

### 原始文档

7. **`20.md`** (30 KB)
   - Java原始代码

8. **`moni.md`** (11 KB)
   - 代码逻辑分析

---

## 🎯 核心成果

### 项目配置
- 系统容量: **10 kW**
- 电池容量: **5 kWh**
- 净投资: **$17,000**

### 关键财务指标

| 指标 | 数值 | 说明 |
|------|------|------|
| 💰 **20年总节省** | **$65,991.67** | 相对于无太阳能系统 |
| ⏱️ **回本周期** | **5.15 年** | 约62个月 |
| 📈 **内部收益率(IRR)** | **16.88%** | 显著优于其他投资 |
| 🔋 **购电减少** | **89.1%** | 从174,000降至15,989 kWh |
| ☀️ **总发电量** | **231,095 kWh** | 20年累计 |
| 🌱 **碳减排** | **~173 吨CO₂** | 相当于种植7,900棵树 |

---

## 📊 数据亮点

### 投资回报
- 第1年节省: $3,374
- 第5年末: **已回本** ✅
- 第10年末: 纯收益 $23,889
- 第20年末: 纯收益 **$48,992**

### 能源独立性
- 自用率: **70%**（含电池）
- 夏季月份（4-8月）: 净卖电（电费为负）
- 冬季月份: 仅需少量购电

### 年度趋势
```
年份 | 发电量(kWh) | 累计节省($) | 状态
-----|-------------|-------------|--------
  1  |  12,000     |   3,374     | 投资期
  5  |  11,809     |  18,613     | ✅ 已回本
 10  |  11,530     |  40,889     | 纯收益 $23,889
 20  |  11,078     |  65,992     | 纯收益 $48,992
```

---

## 🚀 快速开始

### 1. 查看总体分析
```bash
# 用Markdown阅读器打开
open 数据分析报告.md
```

### 2. Excel分析数据
```bash
# 用Excel打开CSV文件
open 财务数据_240个月.csv
```
建议操作：
- 创建数据透视表（年份 × 累计节省）
- 绘制折线图（发电量趋势、回本进度）
- 筛选特定年份查看详情

### 3. 程序化读取
```python
import json

with open('financial_simulation_240months.json', 'r') as f:
    data = json.load(f)

# 查看总结
print(data['summary']['performance_20years'])

# 查看第1个月数据
print(data['monthly_data'][0])
```

---

## 🔧 自定义模拟

修改 `financial_simulator.py` 中的参数，然后运行：

```bash
# 1. 编辑参数
nano financial_simulator.py

# 2. 重新模拟
python3 financial_simulator.py

# 3. 导出CSV
python3 export_csv.py
```

### 可调参数示例

**场景1: 更大系统（15kW）**
```python
'system_size_kw': Decimal('15.0'),
'upfront_investment': Decimal('28000'),
'final_price': Decimal('24000'),
```

**场景2: 不同电价**
```python
'electricity_price_per_kwh': Decimal('0.35'),
'feed_in_tariff': Decimal('0.08'),
```

**场景3: 无电池系统**
```python
'battery_capacity_kwh': Decimal('0.0'),
```

---

## 💡 重要发现

### 投资价值
✅ **强烈推荐** - 该系统具有优秀的投资回报：
- 回本周期仅5.15年
- IRR高达16.88%（远超银行利率3-5%和股市平均8-10%）
- 20年净收益约$49,000

### 电价对冲
- 电价年增2.5%，20年累计上涨约64%
- 太阳能系统有效对冲未来电价风险
- 第20年年节省额是第1年的1.55倍

### 能源安全
- 89%的用电来自自发电
- 显著提升能源独立性
- 不受电网停电影响（配合电池）

---

## ⚠️ 注意事项

### 简化假设
- ⚠️ 月度用电量假设恒定（实际有季节波动）
- ⚠️ 发电量按理论值估算（实际受天气影响）
- ⚠️ 未包含设备维护成本（建议预留5-10%）
- ⚠️ 未包含第10年电池更换成本（约$5,000）

### 建议
1. 结合实际场地的发电数据校准模型
2. 考虑增加维护成本预算
3. 规划第10年电池更换资金
4. 关注电价政策变化

---

## 📖 技术说明

### 计算逻辑基于
- Java代码: `DesignSchemeCommonCalDomainImpl`
- 自用率计算: `calBaseData()` 方法
- 20年财务模型: `calculate20YearDataFromDayBaseData()` 方法

### 关键公式
```
月发电量 = 系统容量 × 年发电小时数 × 月度占比 × 衰减因子^(年-1)
自用率 = (直接自用 + 电池放电) / 发电量
月节省 = 无太阳能电费 - (购电费用 - 馈网收入)
回本期 = 净投资 / 年均节省
IRR = 使现金流NPV=0的折现率
```

### 参数设置
- 购电单价: $0.30/kWh
- 上网电价: $0.05/kWh
- 电价膨胀率: 2.5%/年
- 发电衰减率: 0.4%/年
- 自用率: 70%（有电池），40%（无电池）

---

## 📞 支持

### 常见问题

**Q: CSV文件打开乱码怎么办？**  
A: 用Excel打开时选择UTF-8编码，或用Numbers/WPS Office打开。

**Q: 如何修改参数重新模拟？**  
A: 编辑 `financial_simulator.py`，修改 `__init__` 方法中的参数，然后运行脚本。

**Q: 数据可靠性如何？**  
A: 核心财务逻辑基于原Java代码，衰减率、膨胀率等参数准确。月度分布为简化估算，建议结合实际数据校准。

**Q: 240个月数据太多，如何分析？**  
A: 推荐用Excel的数据透视表按年度汇总，或直接查看JSON的summary部分。

---

## 📚 文档索引

- **快速了解** → `数据分析报告.md`
- **详细使用** → `使用指南.md`
- **代码逻辑** → `20.md` + `moni.md`
- **自定义模拟** → `financial_simulator.py`

---

## ✨ 总结

已成功生成完整的20年240个月太阳能系统财务模拟数据，包括：
- ✅ JSON格式完整数据（139 KB）
- ✅ Excel可用CSV表格（240行）
- ✅ 详细分析报告和使用指南
- ✅ 可自定义的Python模拟器

**关键发现**: 该10kW+5kWh系统投资$17,000，5.15年回本，IRR 16.88%，20年净收益约$49,000，具有优秀的投资价值。

---

**生成时间**: 2025-10-24  
**数据版本**: v1.0  
**工具**: Python财务模拟器
